# sirbrillig/wordpresscopy

Using two files, a tar of an existing WordPress install directory and a sql file
of the site's database (generated by mysqldump), re-create the WordPress site.

The intent of this is to create a dev/test server for an existing WordPress
install. It is designed with [vagrant](http://www.vagrantup.com/) in mind, but
should work in any Puppet setup.

## Install

If you are using [librarian-puppet](http://librarian-puppet.com/) (which I would recommend), just add the following to your Puppetfile:

    mod 'sirbrillig/wordpresscopy', :git => 'git://github.com/sirbrillig/sirbrillig-wordpresscopy.git'

And then run `librarian-puppet install`

## Configuration

Take a look at `sample-puppet-manifest.pp` in the module directory.

In general, you'll want to set up a LAMP stack to manage your wordpress install,
so you will probably want something like the following:

    class { 'mysql': }
    class { 'mysql::server': }
    class { 'wordpresscopy': 
      wp_site_file => '/vagrant/wordpress.tar.gz',
      wp_db_dump => '/vagrant/wordpress.mysql',
      db_name => 'wordpress',
      db_user => 'wordpress',
      db_password => 'password',
      old_site_host => 'oldsite.foo.com',
      new_site_host => 'newsite.foo.com',
    }
    class { 'apache': }
    class { 'apache::mod::php': }
    package { 'php5-gd': 
      ensure => 'present',
    } 
    package { 'php5-curl': 
      ensure => 'present',
    } 
    class { 'mysql::php': }
    apache::vhost { 'newsite.foo.com':
      priority        => '10',
      vhost_name      => '*',
      port            => '80',
      docroot         => '/opt/wordpress/',
      override        => 'all',
    }

The really important configuration pieces here are `wp_site_file` and
`wp_db_dump`. These need to point to your entire tar-and-gzipped (.tar.gz)
wordpress directory and your mysql dump file (.mysql) respectively. In the
example, I put them into the directory with my Vagrantfile and then referenced
them through the automount. You could also put them directly into the `files/`
directory of the module and then reference them with a `puppet:///` URL. There
are many options.

The intended way to create the site file and the dump is as follows:
    
    cd /opt # or wherever your install resides.
    tar czvf /tmp/wordpress.tar.gz wordpress # or whatever your install directory is called.
    mysqldump -uroot -p wordpress > /tmp/wordpress.mysql # or whatever your wordpress database is called.

## License

Apache License, Version 2.0


## Contact

Payton Swick <payton@foolord.com>


## Support

See the github repo for the module: https://github.com/sirbrillig/sirbrillig-wordpresscopy
